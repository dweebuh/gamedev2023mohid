
<html>
<head>
  <meta charset="UTF-8">
  <title>T4A05 Template with WASD and Arrow Keys</title>
</head> 

<body id="myBody" style="background-repeat: repeat; background-size: 80%" background="Water Background.png" onkeydown="handleKeyPress(event)" onload="initialize()">

  <h1 align=center><font color=Black>WASD to MOVE</font></h1>
    
  <h1 align=center><font color=Black>GET TO THE START BUTTON</font></h1>
    
  <input id="myText01" type="text" value="" size="50" placeholder="Feedback here"><br>

  <input type="button" value="Auto Background Left" onclick="startAutoBackground()">

  <input type="button" value="Right" onclick="moveRight()">

  <input type="button" value="Down" onclick="moveDown()"><br><br>
    
  <img id="myImg01" src="Hook Piskel.png" style="position:absolute; width:100px; height:80px; left: 50px; top:190px;"> 
  <img id="myImg02" src="Portal.png" style="position:absolute; width:500px; height:500px; left:1100px; top:155px;">
  
  <script>
    let myGlobalX = 0;
    let myClock;
    let myScore = 10;
    let keysPressed = {};

    function handleKeyPress(event) {
      keysPressed[event.key] = true;

      if (event.key === 'd' || event.key === 'ArrowRight') { // d or Right Arrow = go right
        moveRight();
      }
      if (event.key === 's' || event.key === 'ArrowDown') { // s or Down Arrow = go down
        moveDown();
      }
      if (event.key === 'w' || event.key === 'ArrowUp') { // w or Up Arrow = go up
        moveUp();
      }
      if (event.key === 'a' || event.key === 'ArrowLeft') { // a or Left Arrow = go left
        moveLeft();
      }

      myCheckHit();
    }

    function handleKeyUp(event) {
      delete keysPressed[event.key];
    }

    function moveRight() {
      document.getElementById('myImg01').style.left = parseInt(document.getElementById('myImg01').style.left) + 10 + 'px';
    }

    function moveDown() {
      document.getElementById('myImg01').style.top = parseInt(document.getElementById('myImg01').style.top) + 10 + 'px';
    }

    function moveUp() {
      document.getElementById('myImg01').style.top = parseInt(document.getElementById('myImg01').style.top) - 10 + 'px';
    }

    function moveLeft() {
      document.getElementById('myImg01').style.left = parseInt(document.getElementById('myImg01').style.left) - 10 + 'px';
    }

    function startAutoBackground() {
      clearInterval(myClock);
      myClock = setInterval(function() {
        myGlobalX -= 5;
        let myTemp = myGlobalX + 'px 0px';
        document.getElementById('myBody').style.backgroundPosition = myTemp;
      }, 100);
    }

    function myHitOther(my1, my2) {
      let element1 = document.getElementById(my1);
      let element2 = document.getElementById(my2);

      let rect1 = element1.getBoundingClientRect();
      let rect2 = element2.getBoundingClientRect();

      return (
        rect1.right >= rect2.left &&
        rect1.bottom >= rect2.top &&
        rect1.left <= rect2.right &&
        rect1.top <= rect2.bottom
      );
    }

    function myCheckHit() {
      document.getElementById('myText01').value = myScore; // show the present score

      // Check if the player collides with the portal
      if (myHitOther('myImg01', 'myImg02')) {
        document.getElementById('myText01').value = 'You hit the portal and you win the game!';
        alert('You Win, now go to the next level');
        document.getElementById('myImg01').style.left = '20px';
        location.href = 'Construct3Game/index.html';
      }
    }

    function initialize() {
      document.addEventListener('keydown', handleKeyPress);
      document.addEventListener('keyup', handleKeyUp);
      
      myClock = setInterval(function() {
        myGlobalX -= 5;
        let myTemp = myGlobalX + 'px 0px';
        document.getElementById('myBody').style.backgroundPosition = myTemp;
      }, 100);
    }
  </script>
</body>
</html>
